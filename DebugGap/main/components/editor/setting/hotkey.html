<html>
    
    <head>
        <title>hotkey configuration</title>
        <script src="../lib/jquery.js"></script>
        <style>input{width:150px;border:1px solid #ccc;height:20px;line-height:20px;text-align:center;border-radius:10px;outline:0}table{width:100%}table td.first{width:30%;text-align:right}table td.last{padding-left:30px}</style>
    </head>
    
    <body>
        <form>
            <table></table>
        </form>
        <script>function HotkeyClass(){this.platform="win",this.init()}function returnData(){var t={status:!0,msg:""},e=_dg119.saveConfig();return 1!=e&&(t.status=!1,t.msg=e),t}HotkeyClass.prototype={init:function(){/mac/i.test(navigator.userAgent)&&(this.platform="mac"),this.existKeys=[],this.render(),this.initEvent()},initEvent:function(){var t=this;$("form table input").bind("keydown",function(e){var a="";return e.ctrlKey&&(a+="Ctrl-"),e.altKey&&(a+="mac"==t.platform?"Option-":"Alt-"),e.shiftKey&&(a+="Shift-"),"mac"==t.platform&&e.metaKey&&(a+="Command-"),a?((parent._dg108._dg119.isPrintableKey(e.keyCode)||-1!=$.inArray(e.keyCode,[37,38,39,40]))&&(a+=-1!=$.inArray(e.keyCode,[37,38,39,40])?t.changeDirectoryWordByCode(e.keyCode):parent._dg108._dg119.isPrintableKey(e.keyCode).toUpperCase(),t.hotkeyExist(a)&&t.changeHotkey(a)!=$(this).attr("placeholder")?(alert(parent.lanObject.settingPage.hotkeyExist),a=$(this).attr("_value")):(t.replaceCacheHotkey($(this).attr("_value"),a),$(this).attr("_value",a),$(this).attr("placeholder",t.changeHotkey(a)),this.blur())),$(this).val(t.changeHotkey(a)),void e.preventDefault()):void e.preventDefault()}),$("form table input").bind("keyup",function(t){var e=$(this).val();if(e){var a=e.slice(-1).charCodeAt(0);90>=a&&a>=65?this.blur():$(this).val("")}}),$("form table input").bind("click",function(t){$(this).val("")}),$("form table input").bind("blur",function(e){$(this).val()||$(this).val(t.changeHotkey($(this).attr("_value")))})},hotkeyExist:function(t){var e=0,a=this.existKeys,r=0;for(e=0;e<a.length;e++)if(a[e].toLowerCase().split("-").sort().join("-")==t.toLowerCase().split("-").sort().join("-")){r=1;break}return r},replaceCacheHotkey:function(t,e){var a=0,r=this.existKeys;for(a=0;a<r.length;a++)if(r[a].toLowerCase().split("-").sort().join("-")==t.toLowerCase().split("-").sort().join("-")){r[a]=e;break}},changeHotkey:function(t){var e=t.split("-");if("mac"==this.platform){var a={Ctrl:"⌃",Option:"⌥",Alt:"⌥",Shift:"⇧",Command:"⌘"};t=[];for(var r in a)-1!=window.parent.$.inArray(r,e)&&t.push(a[r]);return t.push(this.changeDirectoryWord(e[e.length-1].toUpperCase())),t.join("")}return e[e.length-1]=this.changeDirectoryWord(e[e.length-1].toUpperCase()),e.join("-")},changeDirectoryWord:function(t){var e=t;switch(t){case"LEFT":e="←";break;case"RIGHT":e="→";break;case"UP":e="↑";break;case"DOWN":e="↓"}return e},changeDirectoryWordByCode:function(t){switch(t){case 37:t="Left";break;case 38:t="Up";break;case 39:t="Right";break;case 40:t="Down"}return t},render:function(){var t,e,a=window.parent._dg122.getConfig("hotkeys"),r=[];for(var i in a)t=a[i],t.close||t.hidden||(this.existKeys.push(t.bindKey[this.platform]),e=this.changeHotkey(t.bindKey[this.platform]),r.push('<tr><td class="first"><input type="txt" name="',i,'" value="',e,'" _value="',t.bindKey[this.platform],'" placeholder="',e,'"/></td><td class="last">',parent.lanObject.hotkey[t.func],"</td><tr>"));$("form table").html(r.join(""))},saveConfig:function(){var t=!0;try{for(var e,a,r=$("form input"),i=window.parent._dg122.getConfig("hotkeys"),n=0,o=r.length;o>n;n++)e=$(r[n]).attr("name"),a=$(r[n]).attr("_value"),i[e]&&(i[e].bindKey[this.platform]=a.replace(/[A-Z]$/,function(t){return t.toLowerCase()}));window.parent._dg122.saveConfig("hotkeys",i),localStorage.hotkeys=JSON.stringify(i)}catch(s){t=s.message}return t}};var _dg119=new HotkeyClass</script>
    </body>

</html>